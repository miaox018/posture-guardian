<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å§¿åŠ¿å®ˆæŠ¤è€… - Content Script æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
        }
        .status.success { background: #d1fae5; color: #065f46; }
        .status.error { background: #fee2e2; color: #991b1b; }
        .status.warning { background: #fef3c7; color: #92400e; }
        pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 12px;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px 10px 0;
        }
        button:hover {
            background: #2563eb;
        }
    </style>
</head>
<body>
    <div class="test-card">
        <h1>ğŸ§ª å§¿åŠ¿å®ˆæŠ¤è€… - Content Script æµ‹è¯•é¡µé¢</h1>
        <p>æ­¤é¡µé¢ç”¨äºéªŒè¯Content Scriptæ˜¯å¦æ­£ç¡®æ³¨å…¥å’Œæ‰§è¡Œã€‚</p>
        
        <div id="status" class="status warning">
            ğŸ“¡ ç­‰å¾…Content Scriptæ³¨å…¥...
        </div>
        
        <div>
            <button onclick="checkConsole()">ğŸ“Š æ£€æŸ¥Consoleæ—¥å¿—</button>
            <button onclick="testExtension()">ğŸ”§ æµ‹è¯•æ‰©å±•åŠŸèƒ½</button>
            <button onclick="manualCheck()">ğŸ” æ‰‹åŠ¨æ£€æŸ¥</button>
            <button onclick="clearLogs()">ğŸ§¹ æ¸…ç©ºæ—¥å¿—</button>
        </div>
        
        <h3>ğŸ“‹ æ£€æŸ¥æ¸…å•</h3>
        <div id="checklist">
            <div>âœ… é¡µé¢å·²åŠ è½½</div>
            <div id="script-check">â³ ç­‰å¾…Content Script...</div>
            <div id="console-check">â³ ç­‰å¾…Consoleæ—¥å¿—...</div>
            <div id="function-check">â³ ç­‰å¾…åŠŸèƒ½æµ‹è¯•...</div>
        </div>
        
        <h3>ğŸ“ å®æ—¶æ—¥å¿—</h3>
        <pre id="logs">é¡µé¢åŠ è½½æ—¶é—´: ${new Date().toLocaleTimeString()}\nç­‰å¾…Content Scriptæ³¨å…¥...</pre>
    </div>

    <script>
        let logCount = 0;
        
        function addLog(message) {
            const logs = document.getElementById('logs');
            logCount++;
            logs.textContent += `\n[${logCount}] ${new Date().toLocaleTimeString()} - ${message}`;
            logs.scrollTop = logs.scrollHeight;
        }
        
        function updateStatus(message, type = 'warning') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }
        
        function checkConsole() {
            addLog('ç”¨æˆ·æ‰‹åŠ¨æ£€æŸ¥Consoleæ—¥å¿—');
            updateStatus('ğŸ“Š è¯·æŸ¥çœ‹Chrome DevTools Consoleæ ‡ç­¾é¡µçš„è¾“å‡º', 'warning');
        }
        
        function testExtension() {
            addLog('å¼€å§‹æµ‹è¯•æ‰©å±•åŠŸèƒ½...');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰Content Scriptæ³¨å…¥
            if (window.postureGuardianContentScript) {
                addLog('âœ… Content Scriptå·²æ³¨å…¥');
                addLog(`ç‰ˆæœ¬: ${window.postureGuardianContentScript.version}`);
                addLog(`åŠ è½½æ—¶é—´: ${window.postureGuardianContentScript.loadTime}`);
                addLog(`æ¨¡å¼: ${window.postureGuardianContentScript.mode}`);
                document.getElementById('script-check').textContent = 'âœ… Content Scriptå·²æ³¨å…¥';
                updateStatus('ğŸ‰ Content Scriptå·¥ä½œæ­£å¸¸ï¼', 'success');
            } else {
                addLog('âŒ Content Scriptæœªæ£€æµ‹åˆ°');
                addLog('å°è¯•æ‰‹åŠ¨æ£€æŸ¥å…¨å±€å˜é‡...');
                
                // æ‰‹åŠ¨æ£€æŸ¥
                setTimeout(() => {
                    if (window.postureGuardianContentScript) {
                        addLog('ğŸ”„ å»¶è¿Ÿæ£€æŸ¥æˆåŠŸï¼Content Scriptå·²æ³¨å…¥');
                        document.getElementById('script-check').textContent = 'âœ… Content Scriptå·²æ³¨å…¥ï¼ˆå»¶è¿Ÿæ£€æµ‹ï¼‰';
                        updateStatus('ğŸ‰ Content Scriptå·¥ä½œæ­£å¸¸ï¼ï¼ˆå»¶è¿Ÿæ£€æµ‹ï¼‰', 'success');
                    } else {
                        document.getElementById('script-check').textContent = 'âŒ Content Scriptæœªæ£€æµ‹åˆ°';
                        updateStatus('âŒ Content Scriptæœªæ³¨å…¥æˆ–æ‰§è¡Œå¤±è´¥', 'error');
                        
                        // æä¾›æ‰‹åŠ¨æ£€æŸ¥å»ºè®®
                        addLog('è¯·åœ¨Consoleä¸­æ‰§è¡Œ: console.log(window.postureGuardianContentScript)');
                    }
                }, 2000);
            }
        }
        
        function manualCheck() {
            addLog('æ‰§è¡Œæ‰‹åŠ¨æ£€æŸ¥...');
            console.log('ğŸ” æ‰‹åŠ¨æ£€æŸ¥å…¨å±€å˜é‡:', window.postureGuardianContentScript);
            
            if (window.postureGuardianContentScript) {
                addLog('âœ… æ‰‹åŠ¨æ£€æŸ¥æˆåŠŸï¼');
                updateStatus('ğŸ‰ Content Scriptç¡®å®åœ¨å·¥ä½œï¼', 'success');
                document.getElementById('script-check').textContent = 'âœ… Content Scriptå·²æ³¨å…¥ï¼ˆæ‰‹åŠ¨ç¡®è®¤ï¼‰';
            } else {
                addLog('âŒ æ‰‹åŠ¨æ£€æŸ¥ä»ç„¶å¤±è´¥');
                updateStatus('âŒ Content Scriptç¡®å®æœªæ³¨å…¥', 'error');
            }
        }
        
        function clearLogs() {
            document.getElementById('logs').textContent = 'æ—¥å¿—å·²æ¸…ç©º\n';
            logCount = 0;
            addLog('é¡µé¢é‡æ–°å¼€å§‹');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆæ—¶çš„æ£€æŸ¥
        document.addEventListener('DOMContentLoaded', () => {
            addLog('DOMåŠ è½½å®Œæˆ');
            
            // ç­‰å¾…ä¸€ä¸‹å†æ£€æŸ¥Content Script
            setTimeout(() => {
                testExtension();
            }, 3000);
        });
        
        // ç›‘å¬é¡µé¢å¯è§æ€§å˜åŒ–
        document.addEventListener('visibilitychange', () => {
            addLog(`é¡µé¢å¯è§æ€§å˜åŒ–: ${document.visibilityState}`);
        });
        
        addLog('æµ‹è¯•é¡µé¢è„šæœ¬å·²å¯åŠ¨');
    </script>
</body>
</html> 